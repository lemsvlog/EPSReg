<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flip Cards â€” Signs (Image Front + Korean/English Back + TTS)</title>
<style>
  /* ===== Sky Blue Freeze Theme (compact) ===== */
  :root{
    --bg:#0b1220; --panel:#0f172a; --ink:#e6f0ff; --muted:#a9b4c7; --ring:#29314a;
    --accent:#38bdf8; --accent2:#22d3ee; --good:#10b981; --danger:#ef4444;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 800px at 15% -10%, #0e1c34, transparent),
                     radial-gradient(1000px 600px at 100% 0%, #0b1326, transparent),
                     var(--bg);color:var(--ink);
       font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;}
  header{display:flex;gap:.75rem;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid #19223a;background:#0b1428cc;backdrop-filter:blur(6px);position:sticky;top:0;z-index:5}
  header .left, header .right{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}
  h1{font-size:16px;margin:0;color:var(--ink);font-weight:650;letter-spacing:.3px}
  .pill{display:inline-flex;align-items:center;gap:.5rem;border:1px solid var(--ring);background:#0d1b34;border-radius:999px;padding:6px 10px}
  .pill input[type="checkbox"]{accent-color:var(--accent)}
  .btn{appearance:none;border:1px solid var(--ring);background:#0e1a30;color:var(--ink);padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.25)}
  .btn:hover{border-color:#35507a}
  .btn:active{transform:translateY(1px)}
  .btn.ghost{background:transparent}
  .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#001827;border:none}
  .grid{display:grid;grid-template-columns:1fr;gap:14px;max-width:1100px;margin:8px auto 90px;padding:12px} 
  .board{display:grid;grid-template-columns:1fr;gap:16px}

  /* Card 3D flip */
  .stage{perspective: 1400px; display:grid; place-items:center;}
  .card{width:min(92vw,820px);height:clamp(420px,68vh,760px);position:relative;transform-style:preserve-3d;transition:transform .8s cubic-bezier(.2,.8,.2,1);}  
  .card.flipped{transform:rotateY(180deg)}
  .face{position:absolute;inset:0;border-radius:18px;overflow:hidden;box-shadow:0 24px 60px rgba(0,0,0,.5),inset 0 0 0 1px #1d2b48;background:#0e1b31}
  .front{backface-visibility:hidden;display:grid;place-items:center;padding:12px;background:#0a1424}
  .back{transform:rotateY(180deg);backface-visibility:hidden;display:flex;flex-direction:column}

  /* Front image unified frame */
  .imgwrap{width:min(92vw,720px);height:clamp(300px,56vh,560px);display:grid;place-items:center;background:#0b1528;border:1px solid #1b2a49;border-radius:14px;box-shadow:inset 0 0 0 1px #1d2b48,0 16px 40px rgba(0,0,0,.45);padding:8px} 
  .imgwrap img{max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain;display:block} 

  .back .info{display:flex;flex-direction:column;gap:10px;padding:18px}
  .en{font-size: clamp(16px,2.2vw,20px); color:var(--muted);}
  .ko{font-size: clamp(20px,3vw,30px); font-weight:800; letter-spacing:.2px}
  .controls{display:flex;flex-wrap:wrap;gap:8px;padding:12px;justify-content:center}
  .index{font-size:13px;color:var(--muted);text-align:center;padding-bottom:8px}

  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .input{background:#0b162c;border:1px solid var(--ring);color:var(--ink);padding:10px 12px;border-radius:10px;min-width:240px}
  .select{appearance:none}

  .small{font-size:12px;color:var(--muted)}

  /* Toolbar (desktop default) */
  .toolbar{position:sticky;bottom:0;left:0;right:0;display:flex;gap:10px;justify-content:center;align-items:center;padding:10px;border-top:1px solid #1b2a49;background:#0b1428e6;backdrop-filter:blur(6px);z-index:6}
  .toolbar .btn{min-width:120px} 

  /* Mobile tweaks */
  @media (max-width:640px){
    header{gap:.5rem}
    .btn{padding:14px 16px;font-size:16px;border-radius:14px;min-height:48px}
    .card{height:64vh}
    .ko{font-size: clamp(18px,5vw,26px)}
    .en{font-size: clamp(14px,4vw,18px)}
    .imgwrap{width:96vw;height:48vh;padding:8px}
    .toolbar{position:sticky;bottom:0;left:0;right:0;display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px;border-top:1px solid #1b2a49;background:#0b1428e6;backdrop-filter:blur(6px)}
    .toolbar .btn{width:100%}
  }
    .toolbar .btn{width:100%}
  }
    .btn{padding:12px 14px;font-size:15px;border-radius:12px}
    .card{height:58vh}
    .ko{font-size: clamp(18px,5vw,26px)}
    .en{font-size: clamp(14px,4vw,18px)}
    .front img{max-width:90%;max-height:70%}
  }
  

</style>
<style>
  .floating-home {
    position: fixed;
    top: 0;
    right: 0;
    background: linear-gradient(90deg, #67e8f9, #38bdf8);
    color: #072235;
    font-size: 14px;
    font-weight: 700;
    text-decoration: none;
    padding: 8px 16px;
    border-radius: 0 0 0 10px;
    box-shadow: 0 6px 18px rgba(56,189,248,.35);
    z-index: 9999;
    transition: all 0.25s ease;
    backdrop-filter: blur(8px) saturate(140%);
    -webkit-backdrop-filter: blur(8px) saturate(140%);
  }
  .floating-home:hover {
    filter: brightness(1.12);
    box-shadow: 0 0 12px rgba(56,189,248,.55),
                0 0 24px rgba(103,232,249,.45);
    transform: translateY(-1px);
  }
</style>
</head>
<body>
<a href="index.html" class="floating-home">Home</a>
  <header>
    <div class="left">
      <h1>Flip Cards â€” Signs</h1>
      <label class="pill"><input id="randomToggle" type="checkbox"/> <span>Random mode</span></label>
      <label class="pill"><input id="autoplayToggle" type="checkbox" checked/> <span>Autoplay Korean TTS on flip</span></label>
    </div>
    <div class="right"></div>
  </header>
  <div class="toolbar">
    <button class="btn ghost" id="prevBtn">â—€ Prev</button>
    <button class="btn" id="flipBtn">Flip / Play</button>
    <button class="btn ghost" id="nextBtn">Next â–¶</button>
    <button class="btn primary" id="shuffleBtn">Shuffle All</button>
  </div>
  <main class="grid">
    <div class="stage">
      <div class="card" id="card">
        <div class="face front">
          <!-- FRONT: your image goes here via JS; path pattern: sign/<English name>.png  -->
          <div class="imgwrap"><img id="frontImg" alt="Sign" src=""/></div>
        </div>
        <div class="face back">
          <div class="info">
            <div class="en" id="enText">â€”</div>
            <div class="ko" id="koText">â€”</div>
            <div class="row">
              <button class="btn" id="playBtn">â–¶ Play (Korean TTS)</button>
              <span class="small" id="audioHint">(Uses browser Textâ€‘toâ€‘Speech)</span>
            </div>
          </div>
          <div class="controls">
            <select id="jumpSelect" class="input select" title="Jump to item"></select>
          </div>
          <div class="index" id="indexText">â€”</div>
        </div>
      </div>
    </div>
  </main>

<script>
/**
 * DATA SETUP
 * Image path pattern:    sign/<English name>.png
 * TTS is generated in the browser (no audio files needed).
 */
const IMAGE_PREFIX = 'sign/';

const CARDS = [
   { "ko": "ê²½ê³ : ìƒë¬¼í•™ì  ìœ„í•´", "en": "BIOLOGICAL HAZZARD" },
  { "ko": "ê²½ê³ : ì „ê¸°", "en": "ELECTRICITY" },
  { "ko": "ê²½ê³ : ì¶”ë½", "en": "FALL" },
  { "ko": "ê²½ê³ : ë‚™í•˜ë¬¼", "en": "FALLING OBJECTS" },
  { "ko": "ê²½ê³ : ì¸í™” ë¬¼ì§ˆ", "en": "FLAMMABLE MATERIALS" },
  { "ko": "ê³µê³ : ì§€ê²Œì°¨ì™€ ì‚°ì—…ìš© ìš´ë°˜ê¸°ê³„", "en": "FORKLIFT TRUCKS AND OTHER INDUSTRIAL VEHICLES" },
  { "ko": "ì¼ë°˜ ê²½ê³ í‘œì§€", "en": "GENERAL WARNING SIGN" },
  { "ko": "ê²½ê³ : ëœ¨ê±°ìš´ í‘œë©´", "en": "HOT SURFACE" },
  { "ko": "ê²½ê³ : ë°©ì‚¬ëŠ¥ ë¬¼ì§ˆ ë˜ëŠ” ì´ì˜¨í™” ë°©ì‚¬ì„ ", "en": "RADIOACTIVE MATERIALS OR IONIZING" },
  { "ko": "ê²½ê³ : ë°”ë‹¥ë©´ ìž¥ì• ë¬¼", "en": "OBSTACLE ON FLOOR" },
  { "ko": "ê²½ê³ : ë¯¸ë„ëŸ¬ìš´ í‘œë©´", "en": "SLIPPERY SURFACE" },
  { "ko": "ê²½ê³ : ë…ì„±ë¬¼ì§ˆ", "en": "TOXIC SUBSTANCES" },
  { "ko": "ì¼ë°˜ì ì¸ ê°•ì œ í–‰ë™ í‘œì§€", "en": "GENERAL MANDATORY SIGN" },
  { "ko": "ìž ê·¸ì‹œì˜¤", "en": "LOCK IT" },
  { "ko": "ì‚¬ìš©ì„¤ëª…ì„œ/ì±…ìžë¥¼ ì°¸ì¡°í•˜ì‹œì˜¤", "en": "REFER TO THE USER MANUAL" },
  { "ko": "ê²½ì ì„ ìš¸ë¦¬ì‹œì˜¤", "en": "SOUND HORN" },
  { "ko": "ì „ê¸°í”ŒëŸ¬ê·¸ë¥¼ ì½˜ì„¼íŠ¸ì—ì„œ ë¶„ë¦¬í•˜ì‹œì˜¤", "en": "UNPLUG ELECTRICAL" },
  { "ko": "ì†ìž¡ì´ë¥¼ ì‚¬ìš©í•˜ì‹œì˜¤", "en": "USE THE HANDRAIL" },
  { "ko": "ì´ í†µë¡œë¥¼ ì´ìš©í•˜ì‹œì˜¤", "en": "USE THIS PASSAGE" },
  { "ko": "ì“°ë ˆê¸°í†µì„ ì‚¬ìš©í•˜ì‹œì˜¤", "en": "USE TRASH CAN" },
  { "ko": "ì†ì„ ì”»ìœ¼ì‹œì˜¤", "en": "WASH HANDS" },
  { "ko": "ê·€ë§ˆê°œë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR EARPLUGS" },
  { "ko": "ë§ˆìŠ¤í¬ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR FACE MASK" },
  { "ko": "ì–¼êµ´ë³´í˜¸êµ¬ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR FACE PROTECTION" },
  { "ko": "ë¨¸ë¦¬ ë³´í˜¸êµ¬ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR HEAD PROTECTION" },
  { "ko": "ê°€ì‹œì„±ì´ ë†’ì€ ì˜·ì„ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR HIGH VISIBILITY CLOTHING" },
  { "ko": "ë¶ˆíˆ¬ëª… ë³´ì•ˆëŒ€ë¥¼ ë°˜ë“œì‹œ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR OPAQUE PROTECTIVE GOGGLES" },
  { "ko": "ë°©í˜¸ë³µì„ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR PROTECTING CLOTHING" },
  { "ko": "ë³´í˜¸ìš© ì•žì¹˜ë§ˆ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR PROTECTIVE APRON" },
  { "ko": "ë³´í˜¸ ìž¥ê°‘ì„ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR PROTECTIVE GLOVES" },
  { "ko": "í˜¸í¡ê¸° ë³´í˜¸ ìž¥ì¹˜ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR RESPIRATORY" },
  { "ko": "ë³´ì•ˆê²½ì„ ë°˜ë“œì‹œ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR SAFETY GOGGLES" },
  { "ko": "ì•ˆì „ë ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR SAFETY HARNESS" },
  { "ko": "ì•ˆì „í™”ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR SAFETY SHOES" },
  { "ko": "ì•ˆì „ë²¨íŠ¸ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR SAFETYBELT" },
  { "ko": "ìš©ì ‘ ë§ˆìŠ¤í¬ë¥¼ ì°©ìš©í•˜ì‹œì˜¤", "en": "WEAR WELDING MASK" },
  { "ko": "ìžë™ ì‹¬ìž¥ ë°•ë™ê¸°", "en": "AUTOMATED EXTERNAL DEFIBRILLATOR" },
  { "ko": "ìŒë£Œìˆ˜", "en": "DRINKING WATER" },
  { "ko": "ë¹„ìƒ íƒˆì¶œìš© í˜¸í¡ê¸°", "en": "EMERGENCY ESCAPE BREATHING DEVICE" },
  { "ko": "ë¹„ìƒ ì „í™”", "en": "EMERGENCY TELEPHONE" },
  { "ko": "ì‘ê¸‰ì²˜ì¹˜", "en": "FIRST AID" },
  { "ko": "êµ¬ëª… ì¡°ë¼", "en": "LIFE JACKET" },
  { "ko": "êµ¬ëª… ë¶€ì´", "en": "LIFEBUOY" },
  { "ko": "êµ¬ê¸‰ ê°€ë°©", "en": "MEDICAL GRAB BAG" },
  { "ko": "ì‚°ì†Œ í˜¸í¡ê¸°", "en": "OXYGEN RESUSCITATOR" },
  { "ko": "ë“¤ê²ƒ", "en": "STRETCHER" },
  { "ko": "í™”ìž¬ ê²½ë³´ê¸°", "en": "FIRE ALARM" },
  { "ko": "ë°©í™”ë¬¸", "en": "FIRE DOOR" },
  { "ko": "í™”ìž¬ ë¹„ìƒ ì „í™”", "en": "FIRE EMERGENCY PHONE" },
  { "ko": "ì†Œí™”ê¸°", "en": "FIRE EXTINGUISHER" },
  { "ko": "ì†Œë°© í˜¸ìŠ¤ë¦´(ì†Œí™”ì „)", "en": "FIRE HOSE STATION (FIRE HYDRANT)" },
  { "ko": "ì†Œë°© ì‚¬ë‹¤ë¦¬", "en": "FIRE LADDER" },
  { "ko": "ì†Œë°©ìž¥ë¹„", "en": "FIREFIGHTING EQUIPMENT" },
  { "ko": "ì™¼ìª½ì„ ë‹¹ê¸°ë©´ ì—´ë¦¬ëŠ” ë¬¸", "en": "DOOR THAT OPENS BY PULLING ON THE RIGHT SIDE" },
  { "ko": "ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë‹¹ê¸°ë©´ ì—´ë¦¬ëŠ” ë¬¸", "en": "DOOR THAT OPENS BY PULLING ON THE RIGHT SIDE" },
  { "ko": "ì™¼ìª½ìœ¼ë¡œ ë¯¸ë„ëŸ¬ì ¸ ì—´ë¦¬ëŠ” ë¬¸/ì™¼ìª½ ë¯¸ë‹«ì´ ë¬¸", "en": "DOORS THAT OPENS BY SLIDING TO THE LEFT" },
  { "ko": "ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë°€ë©´ ì—´ë¦¬ëŠ” ë¬¸", "en": "DOOR THAT OPENS BY PUSHING ON THE RIGHT SIDE" },
  { "ko": "ì™¼ìª½ìœ¼ë¡œ ë°€ë©´ ì—´ë¦¬ëŠ” ë¬¸", "en": "DOOR THAT OPENS PUSHING ON THE LEFT SIDE" },
  { "ko": "ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë¯¸ë„ëŸ¬ì ¸ ì—´ë¦¬ëŠ” ë¬¸/ì˜¤ë¥¸ìª½ ë¯¸ë‹«ì´ ë¬¸", "en": "DOORS THAT OPENS BY SLIDING TO THE RIGHT" },
  { "ko": "ë¹„ìƒêµ¬ (ì™¼ìª½)", "en": "EMERGENCY EXIT (LEFT)" },
  { "ko": "ë¹„ìƒêµ¬ (ì˜¤ë¥¸ìª½)", "en": "EMERGENCY EXIT (RIGHT)" },
  { "ko": "êµ¬ì¡° ì°½ë¬¸", "en": "RESCUE WINDOW" },
  { "ko": "íƒˆì¶œ ì‚¬ë‹¤ë¦¬ê°€ ìžˆëŠ” ë¹„ìƒ ì°½ë¬¸", "en": "EMERGENCY WINDOW WITH ESCAPE LADDER" },
  { "ko": "íƒˆì¶œ ì‚¬ë‹¤ë¦¬", "en": "ESCAPE LADDER" },
  { "ko": "ë¹„ìƒ ë§ì¹˜", "en": "EMERGENCY HAMMER" },
  { "ko": "ì‹œê³„ ë°©í–¥ìœ¼ë¡œ ëŒë¦¬ë©´ ì—´ë¦¼", "en": "TURN CLOCKWISE TO OPEN" },
  { "ko": "ì‹œê³„ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ëŒë¦¬ë©´ ì—´ë¦¼", "en": "TURN COUNTERCLOCKWISE TO OPEN" },
  { "ko": "ì¼ë°˜ì ì¸ ê¸ˆì§€í‘œì§€", "en": "GENERAL PROHIBITION SIGN" },
  { "ko": "ë¬¼ì„ ë§ˆì‹œì§€ ë§ˆì‹œì˜¤", "en": "DO NOT DRINK" },
  { "ko": "ë¬¼ë¡œ ë¶ˆì„ ë„ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT EXTINGUISH WITH WATER" },
  { "ko": "ì†ì„ ë„£ì§€ ë§ˆì‹œì˜¤(ì† ì‚½ìž… ê¸ˆì§€)", "en": "DO NOT INSERT HAND" },
  { "ko": "ê¸°ëŒ€ì§€ ë§ˆì„¸ìš”", "en": "DO NOT LEAN" },
  { "ko": "íŠ¸ëž™ì„ ë²—ì–´ë‚˜ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT LEAVE THE TOW-TRACK" },
  { "ko": "ìŠ¤ìœ„ì¹˜ì˜ ìƒíƒœë¥¼ ë°”ê¾¸ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT MOVE THE SWITCH" },
  { "ko": "ì˜ìžë¥¼ í”ë“¤ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT SWING THE CHAIR" },
  { "ko": "ë¡œí”„ì— ë§¤ë“­ì„ ì§“ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT TIE KNOTS IN THE ROPE" },
  { "ko": "ë§Œì§€ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT TOUCH" },
  { "ko": "ì´ ìŠ¹ê°•ê¸°ë¥¼ ìŠ¹ê°ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT USE THIS LIFT FOR PASSENGERS" },
  { "ko": "íœ´ëŒ€ìš© ê·¸ë¼ì¸ë”ì— ì‚¬ìš©í•˜ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT USE WITH HANDHELD GRINDER" },
  { "ko": "ìž¥ê°‘ì„ ì°©ìš©í•˜ì§€ ë§ˆì‹œì˜¤", "en": "DO NOT WEAR GLOVES" },
  { "ko": "ì§€ê²Œì°¨, ì‚°ì—…ìš© ì°¨ëŸ‰ ì ‘ê·¼ ê¸ˆì§€", "en": "NO ENTRY FOR FORKLIFTS AND INDUSTRIAL VEHICLES" },
  { "ko": "ì¤‘ë…ëœ ì‚¬ëžŒ ê¸ˆì§€", "en": "INTOXICATED PERSONS PROHIBITED" },
  { "ko": "ì˜¬ë¼ê°€ì§€ ë§ˆì‹œì˜¤", "en": "NO CLIMBING" },
  { "ko": "ì• ê²¬ ê¸ˆì§€", "en": "NO DOGS" },
  { "ko": "ì‹ìŒë£Œ ê¸ˆì§€", "en": "NO EATING OR DRINKING" },
  { "ko": "í†µí–‰ ê¸ˆì§€(í†µí–‰í•˜ì§€ ë§ˆì‹œì˜¤)", "en": "NO ENTRY (DO NOT ENTER)" },
  { "ko": "ì°©í™” ê¸ˆì§€: í™”ìž¬, ë°œí™”ì›ê³¼ ë°œì—° ê¸ˆì§€", "en": "NO IGNITION NO FIRE, IGNITION SOURCES, OR SMOKING" },
  { "ko": "ì‚¬ì§„ ì´¬ì˜ ê¸ˆì§€", "en": "NO PHOTOGRAPHY" },
  { "ko": "ë°€ì§€ ë§ˆì‹œì˜¤", "en": "NO PUSHING" },
  { "ko": "ë‹¬ë¦¬ê¸° ê¸ˆì§€", "en": "NO RUNNING" },
  { "ko": "ì•‰ì§€ ë§ˆì‹œì˜¤", "en": "NO SITTING" },
  { "ko": "ê¸ˆì—°(ë‹´ë°°ë¥¼ í”¼ìš°ì§€ ë§ˆì‹œì˜¤)", "en": "NO SMOKING" },
  { "ko": "ìˆ˜ì˜ ê¸ˆì§€", "en": "NO SWIMMING" },
  { "ko": "í†µí–‰ ê¸ˆì§€(í†µí–‰í•˜ì§€ ë§ˆì‹œì˜¤)", "en": "NO ENTRY" },
  { "ko": "ì˜¥ì™¸ìš© ì‹ ë°œ ê¸ˆì§€", "en": "OUTDOOR FOOTWEAR PROHIBITED" },
  { "ko": "ìž„ì‚°ë¶€ ê¸ˆì§€", "en": "PREGNANT WOMEN PROHIBITED" },
  { "ko": "íœ´ëŒ€í° ì „ì›ì„ ë„ì‹œì˜¤", "en": "TURN OFF YOUR CELLPHONE" }
  // ðŸ‘‰ Add the rest of your items here, same format: { ko:'...', en:'...' }
];

/**
 * UTILITIES
 */
const $ = sel => document.querySelector(sel);
const cardEl = $('#card');
const frontImg = $('#frontImg');
const enText = $('#enText');
const koText = $('#koText');
const indexText = $('#indexText');
const jumpSelect = $('#jumpSelect');
const flipBtn = $('#flipBtn');
const prevBtn = $('#prevBtn');
const nextBtn = $('#nextBtn');
const shuffleBtn = $('#shuffleBtn');
const randomToggle = $('#randomToggle');
const autoplayToggle = $('#autoplayToggle');
const playBtn = $('#playBtn');

let order = [...CARDS.keys()];
let idx = 0; // current index within order[]
let lastRandom = -1;

// ===== Text-to-Speech (Korean) =====
function speakKo(text){
  if(!('speechSynthesis' in window)) return;
  const synth = window.speechSynthesis;
  if(synth.speaking) synth.cancel(); // stop any ongoing speech
  const u = new SpeechSynthesisUtterance(text);
  u.lang = 'ko-KR';
  u.rate = 0.95; // slightly slower for clarity
  u.pitch = 1.0;
  // Try to pick a Korean voice if available
  const voices = synth.getVoices();
  const koVoice = voices.find(v=>/ko/i.test(v.lang));
  if(koVoice) u.voice = koVoice;
  synth.speak(u);
}
window.speechSynthesis && window.speechSynthesis.onvoiceschanged !== undefined && window.speechSynthesis.getVoices();

function preloadImages(){
  order.forEach(i=>{
    const img = new Image();
    img.src = IMAGE_PREFIX + CARDS[i].en + '.png';
  });
}

function updateJumpSelect(){
  jumpSelect.innerHTML = order.map((i, n)=>{
    const label = `${n+1}. ${CARDS[i].en}`;
    return `<option value="${n}">${label}</option>`;
  }).join('');
}

function loadCard(n){
  idx = (n+order.length)%order.length;
  const item = CARDS[order[idx]];
  const imgSrc = IMAGE_PREFIX + item.en + '.png';
  frontImg.src = imgSrc;
  frontImg.alt = item.en;
  enText.textContent = item.en;
  koText.textContent = item.ko;
  indexText.textContent = `${idx+1} / ${order.length}`;
  jumpSelect.value = String(idx);
  // Always show front when loading a new card
  cardEl.classList.remove('flipped');
}

function flipCard(){
  const willFlipToBack = !cardEl.classList.contains('flipped');
  cardEl.classList.toggle('flipped');
  if(willFlipToBack && autoplayToggle.checked){
    setTimeout(()=>{ speakKo(koText.textContent); }, 220);
  }
}

function playTTS(){
  speakKo(koText.textContent);
}

function shuffleArray(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

function nextCard(){
  if(randomToggle.checked){
    let next;
    if(order.length <= 1){ next = 0; }
    else{
      do{ next = Math.floor(Math.random()*order.length); } while(next === lastRandom);
    }
    lastRandom = next;
    loadCard(next);
  }else{
    loadCard(idx+1);
  }
}

function prevCard(){
  if(randomToggle.checked){
    nextCard();
  }else{
    loadCard(idx-1);
  }
}

function shuffleAll(){
  order = shuffleArray([...CARDS.keys()]);
  updateJumpSelect();
  loadCard(0);
}

// ===== event hooks =====
flipBtn.addEventListener('click', flipCard);
frontImg.addEventListener('click', flipCard); // tap image to flip
playBtn.addEventListener('click', playTTS);
nextBtn.addEventListener('click', nextCard);
prevBtn.addEventListener('click', prevCard);
jumpSelect.addEventListener('change', (e)=> loadCard(parseInt(e.target.value,10)||0));
shuffleBtn.addEventListener('click', shuffleAll);

// init
preloadImages();
updateJumpSelect();
loadCard(0);

// Optional: keyboard shortcuts
window.addEventListener('keydown', (e)=>{
  if(e.code==='Space'){e.preventDefault(); flipCard();}
  if(e.code==='ArrowRight'){nextCard();}
  if(e.code==='ArrowLeft'){prevCard();}
});
</script>
</body>
</html>
